<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Yo Energi - AI能量语录</title>
  <style>
    body {
  background: #fff;
  color: #111;
  font-family: 'Helvetica Neue', Helvetica, Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;   /* 让内容垂直居中 */
  min-height: 100vh;
  margin: 0;
}
    }
    #quote {
      margin: 3.5rem auto 2rem auto;
      max-width: 90vw;
      font-size: 1.3rem;
      text-align: center;
      line-height: 1.6;
      min-height: 3em;
    }
    #refreshIcon {
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 56px;
      height: 56px;
      margin: 0 auto;
      touch-action: manipulation;
    }
    #refreshIcon svg {
      width: 44px;
      height: 44px;
    }
  </style>
</head>
<body>
  <div id="quote">“生活就像骑自行车。要想保持平衡，你必须不断前进。”</div>
  <span id="refreshIcon" title="刷新">
    <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M32 20c0 6.627-5.373 12-12 12S8 26.627 8 20 13.373 8 20 8c2.485 0 4.77.755 6.66 2.04" stroke="#111" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M28 6v6h-6" stroke="#111" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </span>
  <script>
    let region = 'china';
    let lang = 'zh';
    // 根据IP自动设置区域和语言，支持多国语言
    window.addEventListener('DOMContentLoaded', async () => {
      try {
        const res = await fetch('https://ipinfo.io/json');
        const data = await res.json();
        const country = data.country || '';
        if (country === 'CN') { region = 'china'; lang = 'zh'; }
        else if (["JP", "KR"].includes(country)) { region = 'japan'; lang = 'ja'; }
        else if (country === 'ID') { region = 'indonesia'; lang = 'id'; }
        else if (["FR", "BE", "CA"].includes(country)) { region = 'france'; lang = 'fr'; }
        else if (["DE", "AT", "CH"].includes(country)) { region = 'germany'; lang = 'de'; }
        else if (["ES", "MX", "AR", "CO", "CL", "PE", "VE", "EC", "GT", "CU", "BO", "DO", "HN", "PY", "SV", "NI", "CR", "UY", "PA", "GQ"].includes(country)) { region = 'spain'; lang = 'es'; }
        else if (["RU", "BY", "KZ", "KG", "UA"].includes(country)) { region = 'russia'; lang = 'ru'; }
        else { region = 'europe'; lang = 'en'; }
      } catch (e) {
        region = 'china'; lang = 'zh';
      }
      updateUILanguage();
    });
    function updateUILanguage() {
      const quoteDiv = document.getElementById('quote');
      if (lang === 'zh') {
        quoteDiv.textContent = '“生活就像骑自行车。要想保持平衡，你必须不断前进。”';
      } else if (lang === 'en') {
        quoteDiv.textContent = '"Life is like riding a bicycle. To keep your balance you must keep moving."';
      } else if (lang === 'ja') {
        quoteDiv.textContent = '「人生は自転車に乗るようなものだ。バランスを保つには走り続けなければならない。」';
      } else if (lang === 'id') {
        quoteDiv.textContent = '"Hidup adalah perjuangan, jangan pernah menyerah."';
      } else if (lang === 'fr') {
        quoteDiv.textContent = '« La vie, c’est comme une bicyclette, il faut avancer pour ne pas perdre l’équilibre. »';
      } else if (lang === 'de') {
        quoteDiv.textContent = '„Das Leben ist wie Fahrrad fahren. Um die Balance zu halten, musst du in Bewegung bleiben.“';
      } else if (lang === 'es') {
        quoteDiv.textContent = '"La vida es como montar en bicicleta. Para mantener el equilibrio, debes seguir adelante."';
      } else if (lang === 'ru') {
        quoteDiv.textContent = '«Жизнь как езда на велосипеде. Чтобы сохранить равновесие, нужно двигаться.»';
      }
    }
    async function fetchOpenAIQuote(region) {
      try {
        const response = await fetch(`/api/quote?region=${region}`);
        if (!response.ok) return null;
        const data = await response.json();
        return data.quote;
      } catch (e) {
        return null;
      }
    }
    const quoteDiv = document.getElementById('quote');
    const icon = document.getElementById('refreshIcon');
    icon.addEventListener('click', async function() {
      if (lang === 'zh') quoteDiv.textContent = '生成中...';
      else if (lang === 'en') quoteDiv.textContent = 'Generating...';
      else if (lang === 'ja') quoteDiv.textContent = '生成中...';
      else if (lang === 'id') quoteDiv.textContent = 'Sedang membuat kutipan...';
      else if (lang === 'fr') quoteDiv.textContent = 'Génération en cours...';
      else if (lang === 'de') quoteDiv.textContent = 'Wird generiert...';
      else if (lang === 'es') quoteDiv.textContent = 'Generando...';
      else if (lang === 'ru') quoteDiv.textContent = 'Генерация...';
      icon.style.transition = 'transform 0.4s';
      icon.style.transform = 'rotate(360deg)';
      setTimeout(() => {
        icon.style.transform = '';
      }, 400);
      const result = await fetchOpenAIQuote(region);
      if (result) quoteDiv.textContent = result;
      else {
        if (lang === 'zh') quoteDiv.textContent = '生成失败，请检查API Key或网络';
        else if (lang === 'en') quoteDiv.textContent = 'Failed to generate. Please check your API Key or network.';
        else if (lang === 'ja') quoteDiv.textContent = '生成に失敗しました。APIキーやネットワークをご確認ください。';
        else if (lang === 'id') quoteDiv.textContent = 'Gagal membuat kutipan. Silakan periksa koneksi Anda.';
        else if (lang === 'fr') quoteDiv.textContent = 'Échec de la génération. Veuillez vérifier votre connexion.';
        else if (lang === 'de') quoteDiv.textContent = 'Generierung fehlgeschlagen. Bitte überprüfen Sie Ihre Verbindung.';
        else if (lang === 'es') quoteDiv.textContent = 'No se pudo generar. Por favor, revise su conexión.';
        else if (lang === 'ru') quoteDiv.textContent = 'Не удалось сгенерировать. Проверьте соединение.';
      }
    });
  </script>
</body>
</html>
